+++
title = "Шифр Цезаря"
weight = 3
+++

Первый шифр, упоминаемый в письменной истории — это шифр Цезаря. Известно, что он использовался императором Гаем Юлием Цезарем для общения с полководцами.

> Если у него было что-либо конфиденциальное для передачи, то он записывал это шифром, то есть так изменял порядок букв алфавита, что нельзя было разобрать ни одно слово. Если кто-либо хотел дешифровать его и понять его значение, то он должен был подставлять четвертую букву алфавита, а именно, D, для A, и так далее, с другими буквами.
_Гай Светоний Транквилл. Жизнь двенадцати цезарей, Книга первая, гл. 56_

Идея шифра проста — передвинуть каждую букву слова на определенное количество знаков вперед по алфавиту. Например, если мы используем число сдвига \\(3\\) для слова `CAESAR`, то получается слово `FDHVDU`.

| Сдвиг | C | A | E | S | A | R |
|-------|---|---|---|---|---|---|
|  +1   | D | B | F | T | B | S |
|  +2   | E | C | G | U | C | T |
|  +3   | F | D | H | V | D | U |

Если при сдвиге происходит переход через букву Z, за ней снова продолжаются A, B, C и т.д. Можно представить эту связь как два кольца, на которые нанесен алфавит. Если расположить их так, чтобы буквы совпадали и потом сдвигать их друг относительно друга, получится примерно такая картина:
```
 A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
 X Y Z A B C D E F G H I J K L M N O P Q R S T U V W
```


Для получения исходного текста достаточно провести обратную процедуру -- передвинуть каждую букву в слове на определенное количество знаков назад. Таким образом, число сдвига -- это *ключ*, который необходим для расшифровки и зашифровки. Ключ известен обеим общающимся сторонам и должен храниться в тайне.

{{% notice note %}}
Как разгадать, какое слово зашифровано шифром `VGXUGE`?
{{% /notice %}}

В наше время сложно признать за таким шифром хоть какую-то степень секретности, однако во время Римской империи он работал весьма хорошо -- причина в малой грамотности населения. Потенциальные противники (чужие племена) тоже не отличались прекрасным знанием латинского языка. Оттого для неосведомленного человека зашифрованный текст мог выглядеть как послание на неизвестном языке.
Тем не менее, для людей, знакомых с латынью, взлом шифра особой сложности не представлял -- требовалось перебрать всего \\(22\\) варианта (классический латинский алфавит состоит из \\(23\\) букв -- получается \\(23\\) комбинации включая исходное слово). Существует мнение, что Цезарь пользовался и более совершенными схемами шифрования.

Посмотреть решение для шифра `VGXUGE`:

| Сдвиг | V | G | X | U | G | E |
|-------|---|---|---|---|---|---|
|  -1   | W | H | Y | V | H | F |
|  -2   | X | I | Z | W | I | G |
|  -3   | Y | J | A | X | J | H |
|  -4   | Z | K | B | Y | K | I |
|  -5   | A | L | C | Z | L | J |
|  -6   | B | M | D | A | M | K |
|  -7   | C | N | E | B | N | L |
|  -8   | D | O | F | C | O | M |
|  -9   | E | P | G | D | P | N |
|  -10  | F | Q | H | E | Q | O |
|  -11  | G | R | I | F | R | P |
|  -12  | H | S | J | G | S | Q |
|  -13  | I | T | K | H | T | R |
|  -14  | J | U | L | I | U | S |

Сдвиг записываем отрицательным, поскольку при расшифровке мы двигаемся в обратную сторону. Итак, зашифровано слово `JULIUS`, сдвиг \\(-14\\) (\\(14\\) шагов назад). Это то же самое, что и \\(12\\) шагов вперед. Посмотрим, как выглядит процесс зашифровки:

| Сдвиг | J | U | L | I | U | S |
|-------|---|---|---|---|---|---|
|  +1   | K | H | Y | V | H | F |
|  +2   | L | I | Z | W | I | G |
|  +3   | M | J | A | X | J | H |
|  +4   | N | K | B | Y | K | I |
|  +5   | O | L | C | Z | L | J |
|  +6   | P | M | D | A | M | K |
|  +7   | Q | N | E | B | N | L |
|  +8   | R | O | F | C | O | M |
|  +9   | S | P | G | D | P | N |
|  +10  | T | Q | H | E | Q | O |
|  +11  | U | R | I | F | R | P |
|  +12  | V | S | J | G | S | Q |

Почему так? Поскольку наш алфавит "закольцован", количество сдвигов ограничено числом букв в алфавите, так же, как и количество минут в часе ограничено \\(60\\)-ю делениями на циферблате часов. Минутная стрелка оказывается на одном и том же месте каждые \\(60\\), \\(120\\), \\(180\\) минут и т.д. Так же и в случае с современным латинским алфавитом -- сдвигаясь на \\(26\\), \\(52\\), \\(104\\) и т.д. позиций, мы будем возвращаться на тот же текст. Соответственно, сдвиги \\(3\\), \\(29\\), \\(55\\), а также и \\(3 - 26 = -23\\) дают одинаковые шифровки.

С математической точки зрения мы имеем дело с модульной арифметикой:
$$26 \mod 26 = 52 \mod 26 = 104 \mod 26 = 0 \mod 26 = -26 \mod 26$$
Нотация \\(x \mod m\\) означает, что в нашей системе существует ограниченное количество чисел от \\(0\\) до \\(m - 1\\) (\\(26\\) в верхнем примере) и все "непомещающиеся" числа \\(x\\) приводятся к необходимому виду через последовательное прибавление или вычитание числа \\(m\\).
$$55\mod 26 = (3 + 26 * 2) \mod 26 = 3 \mod 26$$

Поскольку \\(-14 + 26 = 12\\), сдвиги \\(-14\\) и \\(12\\) эквивалентны.

Таким образом, максимальное число шифровок равно \\(n - 1\\), где \\(n\\) -- количество букв в алфавите. \\(1\\) отнимаем по той причине, одна из комбинаций -- исходный текст. Это означает, что шифр Цезаря легко взламывается методом перебора (brute-force attack).