+++
title = "Шифр с замещением"
weight = 3
+++

Один из ключевых изъянов шифра Цезаря -- сохранение зависимости между буквами. В самом деле, если мы запишем, на каком расстоянии (по алфавиту) от первой буквы находятся остальные, то получим одинаковые значения как для исходного текста, так и для его шифровки:

| Исх. слово |  C |  A |  E |  S |  A |  R |
|------------|----|----|----|----|----|----|
| Расстояние |  0 | -2 |  2 | 15 | -2 | 14 |

| Шифровка   |  F |  D |  H |  V |  D |  U |
|------------|----|----|----|----|----|----|
| Расстояние |  0 | -2 |  2 | 15 | -2 | 14 |

По сути, мы зашифровываем лишь одну букву, поскольку используем один и тот же сдвиг на протяжении всего текста. Если же мы предоставим каждой букве "персональный" сдвиг, количество всех возможных шифровок резко увеличится. Один из наиболее простых способов этого добиться -- записать под настоящим алфавитом перемешанный:
```
 A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
 G M A X Y O U B F Q S W R K L N J C H Z E D I P V T
```

NB! Буквы в нижней строке не могут повторяться, иначе шифровку нельзя будет однозначно дешифровать.

Посмотрим, получилось ли решить проблему шифра Цезаря:

| Исх. слово |  C |  A |  E |  S |  A |  R |
|------------|----|----|----|----|----|----|
| Расстояние |  0 | -2 |  2 | 15 | -2 | 14 |

| Шифровка   |  A |  G |  Y |  H |  G |  C |
|------------|----|----|----|----|----|----|
| Расстояние |  0 |  6 | 24 |  7 |  6 |  2 |


Да. Если мы представим себе алфавит в виде кубиков, сложенных в кучу, и будем по одному складывать их в ряд (как на схеме выше), то для первого места мы можем выбрать один из \\(26\\) кубиков. После того, как кубик занял первое место, для второго места в куче останется \\(25\\) кандидатов. Для третьего -- \\(24\\) и т.д., пока не кончатся кубики. Если мы перемножим все эти числа, получится общее число комбинаций:
$$ 26 \cdot 25 \cdot 24 \cdot \dots \cdot 3 \cdot 2 \cdot 1 = 26! \approx 4.03 \cdot 10^{26} $$
\\(403\\) септиллиона вариантов, в то время как в человеческом теле в среднем содержится \\(7\\) октиллионов (или \\(7000\\) септиллионов) атомов. Это значит, что попытки взломать данный шифр методом перебора в большей степени будут безрезультатны.

Несмотря на потрясающее количество возможных комбинаций, шифр с замещением имеет два изъяна, один из которых позволяет легко его взломать.

### Длина ключа

Для того, чтобы получатель сообщения мог расшифровать текст, ему должна быть известна связь между зашифрованной буквой и её действительным значением. Поэтому, если мы перемешали буквы случайным образом, длина ключа равна количеству букв в алфавите (в нашем случае -- \\(26\\)). Такой ключ сложно запомнить и непросто хранить.

Одно из решений данной проблемы -- придумать кодовое слово, состоящее из неповторяющихся букв (например, `DRAGON`, которое и будет ключом. Получатель, которому известен ключ, восстановит его полную длину, дописав в конце оставшиеся буквы в алфавитном порядке:

```
 A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
 D R A G O N B C E F H I J K L M P Q S T U V W X Y Z
```
Как видим, для ключа желательно подбирать слова подлиннее, поскольку в нашем случае 8 соответствуют самим себе и тем самым могут "выдать" содержание текста.

### Частотный анализ

Методика частотного анализа впервые упоминается у арабского ученого Аль-Кинди (\\(IX\\) век), но широкое распространение получила позднее. В частности, с помощью этого метода было расшифровано значение египетских иероглифов Ж.-Ф. Шампольоном в 1822 году.

Частотный анализ основывается на статистике распространенности букв, фонем и слов в письменной речи (можно сказать, "рейтинге популярности"). Так, при анализе английских текстов выясняется следующая статистика:

| Рейтинг            | Позиции в порядке убывания              |
|--------------------|-----------------------------------------|
| Буквы              | E, T, A, O, I, N, S, ...                |
| Слова из 1-й буквы | I, A                                    |
| Слова из 2-х букв  | OF, TO, IN, IT, IS, BE, ...             |
| Слова из 3-х букв  | THE, AND, FOR, ARE, BUT, NOT, ...       |
| Диграммы           | -th-, -er-, -on-, -an-, -re-, -he-, ... |

Диграммы -- комбинации из двух букв, которые встречаются как в середине, так и в начале или конце слова.
Если составить аналогичную таблицу для зашифрованного текста, итог получится совершенно другой -- например, вместо буквы E на первом месте окажется Z, которая в реальном языке встречается значительно реже. Путем подбора схожих по частоте букв из шифра и настоящего языка, мы сможем за гораздо меньшее время, нежели путем перебора всех ключей, обнаружить содержание текста.
